<style>
  /* ì´ì „/ë‹¤ìŒ ìŠ¬ë¼ì´ë“œ ë²„íŠ¼ ìŠ¤íƒ€ì¼ - ê¸°ë³¸ì€ íˆ¬ëª…, ì¹´ë“œ í˜¸ë²„ ì‹œ ë³´ì„ */
  .slider-prev,
  .slider-next {
    opacity: 0;
    pointer-events: none;
    color: rgba(0, 0, 0, 0.4);
    font-size: 20px;
    background: transparent;
    border: none;
    transition: opacity 0.3s ease, color 0.3s ease;
  }

  /* ì¹´ë“œì— ë§ˆìš°ìŠ¤ ì˜¬ë¦¬ë©´ ìŠ¬ë¼ì´ë“œ ë²„íŠ¼ í™œì„±í™” */
  .card:hover .slider-prev,
  .card:hover .slider-next {
    opacity: 1;
    pointer-events: auto;
    color: rgba(0, 0, 0, 0.85);
  }
</style>

<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<div th:fragment="content">
  <div class="container my-5">
    <h2 class="mb-4 text-center">ğŸ“¦ ì „ì²´ ìƒí’ˆ ëª©ë¡</h2>

    <!-- ìƒí’ˆ ë“±ë¡ ë²„íŠ¼ -->
    <!--
    <div class="text-end mb-3" sec:authorize="isAuthenticated()">
      <a href="/products/new" class="btn btn-primary">ìƒí’ˆ ë“±ë¡</a>
    </div>
    -->
    <!-- ì„ì‹œ: ë¡œê·¸ì¸ ì—¬ë¶€ ìƒê´€ì—†ì´ ë²„íŠ¼ í•­ìƒ í‘œì‹œ -->
    <div class="text-end mb-3">
      <a href="/products/new" class="btn btn-primary">ìƒí’ˆ ë“±ë¡</a>
    </div>

    <!-- ì¹´í…Œê³ ë¦¬ í•„í„° -->
    <div class="row">
      <div class="col-md-3">
        <h5 class="mb-3"></h5>
        <div class="btn-group-vertical w-100" role="group" aria-label="ì¹´í…Œê³ ë¦¬ ì„ íƒ">
          <!-- ì „ì²´ ë²„íŠ¼ -->
          <button type="button"
                  class="btn btn-outline-secondary text-start"
                  style="width: 100%;"
                  data-value=""
                  th:classappend="${not param.containsKey('category') or #strings.isEmpty(param.category)} ? ' active'">
            ì „ì²´
          </button>

          <!-- ì¹´í…Œê³ ë¦¬ ë²„íŠ¼ ë°˜ë³µ -->
          <button type="button"
                  class="btn btn-outline-secondary text-start"
                  style="width: 100%;"
                  th:each="cat : ${mainCategories}"
                  th:data-value="${cat.ctgCode}"
                  th:text="${cat.ctgName}"
                  th:classappend="${#strings.equals(param.category, cat.ctgCode.toString())} ? ' active'">
            ì¹´í…Œê³ ë¦¬ëª…
          </button>

        </div>
        <!-- ê°€ê²© í•„í„° -->
        <!-- ê°€ê²© í•„í„° -->
        <div class="mt-4 p-3 border rounded">
          <h6 class="fw-bold mb-3">ê°€ê²©</h6>
          <div class="d-grid gap-2">
            <button type="button" class="btn btn-outline-secondary" onclick="filterByPrice(0, 5000)" data-min="0" data-max="5000">5,000ì› ì´í•˜</button>
            <button type="button" class="btn btn-outline-secondary" onclick="filterByPrice(0, 10000)" data-min="0" data-max="10000">10,000ì› ì´í•˜</button>
            <button type="button" class="btn btn-outline-secondary" onclick="filterByPrice(0, 20000)" data-min="0" data-max="20000">20,000ì› ì´í•˜</button>
          </div>

          <div class="mt-3 d-flex gap-2 align-items-center">
            <input type="number" class="form-control" id="minPrice" placeholder="ìµœì†Œ" min="0">
            <span>-</span>
            <input type="number" class="form-control" id="maxPrice" placeholder="ìµœëŒ€" min="0">
          </div>

          <button class="btn btn-sm btn-primary w-100 mt-2" onclick="applyPriceRange()">ì ìš©í•˜ê¸°</button>
          <button class="btn btn-sm btn-outline-danger w-100 mt-2" onclick="resetPriceFilter()">ê°€ê²© ì´ˆê¸°í™”</button> <!-- ì—¬ê¸° -->
        </div>

      </div>



      <!-- ìƒí’ˆ ì¹´ë“œ ê·¸ë¦¬ë“œ -->
      <div class="col-md-9">
    <div class="row row-cols-1 row-cols-md-3 g-4">
      <!-- ìƒí’ˆ ë¦¬ìŠ¤íŠ¸ ë°˜ë³µ ì¶œë ¥ -->
      <div class="col" th:each="product : ${productList}">
        <div class="card h-100 shadow-sm">

          <!-- ì´ë¯¸ì§€ ìŠ¬ë¼ì´ë” ì˜ì—­ -->
          <div class="position-relative" style="height: 200px; overflow: hidden;">
            <div class="slider-track d-flex"
                 th:style="'width:' + (${#lists.size(product.imagePaths)} * 100) + '%; height: 100%; transition: transform 0.5s ease;'"
                 th:attr="data-count=${product.imagePaths.size()}">
              <!-- ê° ìƒí’ˆ ì´ë¯¸ì§€ ì¶œë ¥ -->
              <img th:each="img : ${product.imagePaths}"
                   th:if="${product.imagePaths != null}"
                   th:src="@{${img}}"
                   th:style="'width:' + (100 / ${#lists.size(product.imagePaths)}) + '%; height: 100%; object-fit: cover; flex-shrink: 0;'"
              />
            </div>

            <!-- ì´ì „ ë²„íŠ¼: ì´ë¯¸ì§€ 2ì¥ ì´ìƒì¼ ë•Œë§Œ ë³´ì„ -->
            <button th:if="${product.imagePaths.size() > 1}"
                    class="slider-prev btn position-absolute top-50 start-0 translate-middle-y"
                    onclick="slideImage(this, -1)">â®</button>

            <!-- ë‹¤ìŒ ë²„íŠ¼: ì´ë¯¸ì§€ 2ì¥ ì´ìƒì¼ ë•Œë§Œ ë³´ì„ -->
            <button th:if="${product.imagePaths.size() > 1}"
                    class="slider-next btn position-absolute top-50 end-0 translate-middle-y"
                    onclick="slideImage(this, 1)">â¯</button>

            <!-- ì (dot) ë„¤ë¹„ê²Œì´ì…˜: ì´ë¯¸ì§€ 2ì¥ ì´ìƒì¼ ë•Œë§Œ ë³´ì„ -->
            <div th:if="${product.imagePaths.size() > 1}"
                 class="position-absolute bottom-0 start-50 translate-middle-x d-flex gap-1 mb-1">
                <span th:each="i : ${#numbers.sequence(0, #lists.size(product.imagePaths) - 1)}"
                      class="dot bg-dark rounded-circle"
                      th:attr="data-index=${i}"
                      style="width: 6px; height: 6px; opacity: 0.4;"></span>
            </div>
          </div>

          <!-- ìƒí’ˆ ì •ë³´ -->
          <div class="card-body">
            <h5 class="card-title" th:text="${product.title}">ìƒí’ˆëª…</h5>
            <p class="card-text fw-bold" th:text="${#numbers.formatInteger(product.price, 3, 'COMMA') + 'ì›'}">ê°€ê²©</p>
            <!-- ìœ„ì¹˜ ì •ë³´ (ì¶”í›„ ì—°ê´€ê´€ê³„ ìƒê¸°ë©´ í™œì„±í™”) -->
            <!--<p class="text-muted" th:text="${product.location.dongName}">ìœ„ì¹˜</p>-->
          </div>
        </div>
      </div>
    </div>
  </div>
    </div>

  <!-- ìƒí’ˆ ìŠ¬ë¼ì´ë“œ ê¸°ëŠ¥ ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ -->
  <script th:src="@{/js/product.js}"></script>

</div>
